{
	"info": {
		"_postman_id": "ar-invoice-api-collection",
		"name": "AR Invoice API",
		"description": "Complete Postman collection for Accounts Receivable Invoice endpoints with approval workflow, GL integration, and payment tracking",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "AR Invoice",
			"description": "Accounts Receivable Invoice management endpoints with full CRUD, approval workflow, and GL posting",
			"item": [
				{
					"name": "List AR Invoices",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/?customer_id=&currency_id=&country_id=&approval_status=&date_from=&date_to=",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ""],
							"query": [
								{
									"key": "customer_id",
									"value": "",
									"description": "Filter by customer ID",
									"disabled": true
								},
								{
									"key": "currency_id",
									"value": "",
									"description": "Filter by currency ID",
									"disabled": true
								},
								{
									"key": "country_id",
									"value": "",
									"description": "Filter by country ID",
									"disabled": true
								},
								{
									"key": "approval_status",
									"value": "",
									"description": "Filter by approval status (DRAFT/PENDING_APPROVAL/APPROVED/REJECTED)",
									"disabled": true
								},
								{
									"key": "date_from",
									"value": "",
									"description": "Filter by date range start (YYYY-MM-DD)",
									"disabled": true
								},
								{
									"key": "date_to",
									"value": "",
									"description": "Filter by date range end (YYYY-MM-DD)",
									"disabled": true
								}
							]
						},
						"description": "Retrieve list of all AR invoices with optional filters. Returns lightweight ARInvoiceListSerializer data with customer info."
					},
					"response": []
				},
				{
					"name": "Create AR Invoice",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"date\": \"2025-12-10\",\n  \"currency_id\": 1,\n  \"country_id\": 1,\n  \"customer_id\": 1,\n  \"tax_amount\": \"100.00\",\n  \"items\": [\n    {\n      \"name\": \"Software License\",\n      \"description\": \"Annual Enterprise License\",\n      \"quantity\": \"1\",\n      \"unit_price\": \"5000.00\"\n    }\n  ],\n  \"journal_entry\": {\n    \"date\": \"2025-12-10\",\n    \"currency_id\": 1,\n    \"memo\": \"Software license sale to customer\",\n    \"lines\": [\n      {\n        \"amount\": \"5100.00\",\n        \"type\": \"DEBIT\",\n        \"segments\": [\n          {\"segment_type_id\": 1, \"segment_code\": \"1210\"},\n          {\"segment_type_id\": 2, \"segment_code\": \"SALES\"}\n        ]\n      },\n      {\n        \"amount\": \"5100.00\",\n        \"type\": \"CREDIT\",\n        \"segments\": [\n          {\"segment_type_id\": 1, \"segment_code\": \"4010\"},\n          {\"segment_type_id\": 2, \"segment_code\": \"SALES\"}\n        ]\n      }\n    ]\n  }\n}"
						},
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ""]
						},
						"description": "Create a new AR invoice with items and GL distribution.\n\nRequired fields:\n- date (YYYY-MM-DD)\n- currency_id (integer)\n- customer_id (integer) - NOTE: customer_id instead of supplier_id\n- items (array of invoice items)\n- journal_entry (GL distribution)\n\nOptional fields:\n- country_id (integer)\n- subtotal (decimal, auto-calculated from items if not provided)\n- tax_amount (decimal, default: 0.00)\n- total (decimal, auto-calculated if not provided)\n- approval_status (DRAFT/PENDING_APPROVAL/APPROVED/REJECTED, default: DRAFT)\n- payment_status (UNPAID/PARTIALLY_PAID/PAID, default: UNPAID)\n\nEach item requires:\n- name (string)\n- description (string)\n- quantity (decimal)\n- unit_price (decimal)\n\nJournal entry requires:\n- date (YYYY-MM-DD)\n- currency_id (integer)\n- memo (string, optional)\n- lines (array, must be balanced)\n\nEach line requires:\n- amount (decimal)\n- type (DEBIT/CREDIT)\n- segments (array of segment assignments)"
					},
					"response": []
				},
				{
					"name": "Create AR Invoice (Multi-Item)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"date\": \"2025-12-10\",\n  \"currency_id\": 1,\n  \"country_id\": 1,\n  \"customer_id\": 1,\n  \"tax_amount\": \"450.00\",\n  \"items\": [\n    {\n      \"name\": \"Professional Services\",\n      \"description\": \"Consulting - December 2025\",\n      \"quantity\": \"40\",\n      \"unit_price\": \"150.00\"\n    },\n    {\n      \"name\": \"Training\",\n      \"description\": \"On-site training session\",\n      \"quantity\": \"2\",\n      \"unit_price\": \"1500.00\"\n    },\n    {\n      \"name\": \"Support\",\n      \"description\": \"Technical support hours\",\n      \"quantity\": \"10\",\n      \"unit_price\": \"100.00\"\n    }\n  ],\n  \"journal_entry\": {\n    \"date\": \"2025-12-10\",\n    \"currency_id\": 1,\n    \"memo\": \"Services invoice - December 2025\",\n    \"lines\": [\n      {\n        \"amount\": \"10450.00\",\n        \"type\": \"DEBIT\",\n        \"segments\": [\n          {\"segment_type_id\": 1, \"segment_code\": \"1210\"},\n          {\"segment_type_id\": 2, \"segment_code\": \"SALES\"}\n        ]\n      },\n      {\n        \"amount\": \"10450.00\",\n        \"type\": \"CREDIT\",\n        \"segments\": [\n          {\"segment_type_id\": 1, \"segment_code\": \"4020\"},\n          {\"segment_type_id\": 2, \"segment_code\": \"SALES\"}\n        ]\n      }\n    ]\n  }\n}"
						},
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ""]
						},
						"description": "Example with multiple invoice items for services revenue"
					},
					"response": []
				},
				{
					"name": "Get AR Invoice Details",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/:id/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ":id", ""],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "AR Invoice ID"
								}
							]
						},
						"description": "Retrieve detailed information about a specific AR invoice including:\n- Customer details\n- Invoice items\n- Journal entry with GL lines\n- Approval and payment status"
					},
					"response": []
				},
				{
					"name": "Delete AR Invoice",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/:id/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ":id", ""],
							"variable": [
								{
									"key": "id",
									"value": "5",
									"description": "AR Invoice ID"
								}
							]
						},
						"description": "Delete an AR invoice. Only allowed if:\n- Journal entry is not posted to GL\n\nIf the journal entry is posted, deletion is blocked to maintain audit trail."
					},
					"response": []
				},
				{
					"name": "Post to GL",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/:id/post-to-gl/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ":id", "post-to-gl", ""],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "AR Invoice ID"
								}
							]
						},
						"description": "Post the journal entry to General Ledger (mark as posted).\n\nRequirements:\n- Invoice must be APPROVED\n- Journal entry must not already be posted\n\nOnce posted, the journal entry becomes immutable and cannot be modified or deleted."
					},
					"response": []
				},
				{
					"name": "Submit for Approval",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/:id/submit-for-approval/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ":id", "submit-for-approval", ""],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "AR Invoice ID"
								}
							]
						},
						"description": "Submit an AR invoice for approval workflow.\n\nStarts the approval process which may include multiple stages:\n- Credit Check\n- Sales Manager Review\n- Finance Manager Approval\n- CFO Final Approval\n\nReturns workflow instance with status and ID."
					},
					"response": []
				},
				{
					"name": "Get Pending Approvals",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/pending-approvals/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", "pending-approvals", ""]
						},
						"description": "List AR invoices pending approval for the current user.\n\nReturns only invoices where the authenticated user has an active approval assignment.\n\nResponse includes:\n- Invoice details\n- Current approval stage\n- User's approval permissions (can_approve, can_reject, can_delegate)"
					},
					"response": []
				},
				{
					"name": "Approve Invoice",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"action\": \"approve\",\n  \"comment\": \"Approved - customer credit verified and terms confirmed\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/:id/approval-action/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ":id", "approval-action", ""],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "AR Invoice ID"
								}
							]
						},
						"description": "Approve an AR invoice at the current approval stage.\n\nRequest body:\n- action: \"approve\" (or \"approved\")\n- comment: Optional approval comment\n\nUser must have active assignment for current stage."
					},
					"response": []
				},
				{
					"name": "Reject Invoice",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"action\": \"reject\",\n  \"comment\": \"Customer credit limit exceeded - please review payment terms\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/:id/approval-action/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ":id", "approval-action", ""],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "AR Invoice ID"
								}
							]
						},
						"description": "Reject an AR invoice at the current approval stage.\n\nRequest body:\n- action: \"reject\" (or \"rejected\")\n- comment: Required rejection reason\n\nInvoice status will change to REJECTED and workflow will terminate."
					},
					"response": []
				},
				{
					"name": "Delegate Approval",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"action\": \"delegate\",\n  \"target_user_id\": 5,\n  \"comment\": \"Delegating to sales manager for customer relationship review\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/:id/approval-action/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ":id", "approval-action", ""],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "AR Invoice ID"
								}
							]
						},
						"description": "Delegate approval to another user.\n\nRequired fields:\n- action: \"delegate\"\n- target_user_id: ID of user to delegate to\n- comment: Optional delegation note\n\nOnly available if current stage allows delegation."
					},
					"response": []
				},
				{
					"name": "Add Comment",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"action\": \"comment\",\n  \"comment\": \"Please verify customer payment history before final approval\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/:id/approval-action/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ":id", "approval-action", ""],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "AR Invoice ID"
								}
							]
						},
						"description": "Add a comment to the approval workflow without taking action.\n\nRequest body:\n- action: \"comment\"\n- comment: Comment text\n\nComments are recorded in workflow history."
					},
					"response": []
				},
				{
					"name": "Get Invoice Payment Info",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/:invoice_pk/payments/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ":invoice_pk", "payments", ""],
							"variable": [
								{
									"key": "invoice_pk",
									"value": "1",
									"description": "AR Invoice ID"
								}
							]
						},
						"description": "Get payment information for an invoice including:\n- Total amount\n- Paid amount\n- Remaining amount\n- Payment status\n- List of all payments received from customer"
					},
					"response": []
				},
				{
					"name": "Recalculate Invoice Payments",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/finance/invoice/ar/:invoice_pk/recalculate-payments/",
							"host": ["{{base_url}}"],
							"path": ["finance", "invoice", "ar", ":invoice_pk", "recalculate-payments", ""],
							"variable": [
								{
									"key": "invoice_pk",
									"value": "1",
									"description": "AR Invoice ID"
								}
							]
						},
						"description": "Recalculate payment amounts for an invoice.\n\nUseful when payment records may be out of sync.\nUpdates:\n- paid_amount\n- payment_status (UNPAID/PARTIALLY_PAID/PAID)"
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000",
			"type": "string"
		}
	]
}
